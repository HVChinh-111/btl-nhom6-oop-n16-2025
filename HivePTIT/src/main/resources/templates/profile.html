<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/images/LogoProPTIT.png" type="image/png" />
    <link rel="stylesheet" href="/styles/general.css" />
    <title>Profile - HivePTIT</title>
  </head>

  <body class="page">
    <!-- Header chính -->
    <header class="header">
      <nav class="header__nav">
        <!-- Logo và tên -->
        <a href="/" class="header__brand">HivePTIT</a>

        <!-- Menu điều hướng -->
        <ul class="header__menu">
          <li class="header__menu-item">
            <a href="/" class="header__menu-link"> Trang chủ </a>
          </li>
          <li class="header__menu-item">
            <a href="#" class="header__menu-link"> Đang theo dõi </a>
          </li>
          <li class="header__menu-item">
            <a href="/author-ranking" class="header__menu-link"
              >Bảng xếp hạng tác giả</a
            >
          </li>
        </ul>

        <!-- User menu -->
        <div class="header__user">
          <button class="header__avatar-btn">
            <img
              src="/images/avatar.jpeg"
              alt="User Avatar"
              class="header__avatar"
              id="headerAvatar"
              onerror="this.src='/images/avatar.jpeg'"
            />
          </button>
          <!-- User dropdown menu -->
          <div class="header__user-menu">
            <div class="header__user-info">
              <img
                src="/images/avatar.jpeg"
                alt="User Avatar"
                class="header__user-avatar"
                id="userMenuAvatar"
                onerror="this.src='/images/avatar.jpeg'"
              />
              <div class="header__user-details">
                <h4 class="header__user-name" id="userName">Loading...</h4>
                <p class="header__user-username" id="userUsername">@...</p>
              </div>
            </div>
            <div class="header__user-divider"></div>
            <ul class="header__user-options">
              <li>
                <a href="/profile" class="header__user-option-link">
                  <svg
                    class="header__user-option-icon"
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                  >
                    <path
                      d="M10 11C12.7614 11 15 8.76142 15 6C15 3.23858 12.7614 1 10 1C7.23858 1 5 3.23858 5 6C5 8.76142 7.23858 11 10 11Z"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <path
                      d="M1 19C1 15.134 4.13401 12 8 12H12C15.866 12 19 15.134 19 19"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                  </svg>
                  Trang cá nhân
                </a>
              </li>
              <li>
                <a href="#" class="header__user-option-link" id="logoutBtn">
                  <svg
                    class="header__user-option-icon"
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                  >
                    <path
                      d="M7 19H3C1.89543 19 1 18.1046 1 17V3C1 1.89543 1.89543 1 3 1H7"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                    <path
                      d="M14 15L19 10L14 5"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M19 10H7"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                  </svg>
                  Đăng xuất
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Main content -->
    <main class="main">
      <div class="profile">
        <!-- Profile Header -->
        <section class="profile__header">
          <div class="profile__cover"></div>
          <div class="profile__info-wrapper">
            <div class="profile__avatar-section">
              <img
                src="/images/avatar.jpeg"
                alt="Profile Avatar"
                class="profile__avatar"
                id="profileAvatar"
                onerror="this.src='/images/avatar.jpeg'"
              />
            </div>
            <div class="profile__info">
              <h1 class="profile__name" id="profileName">Loading...</h1>
              <p class="profile__username" id="profileUsername">@...</p>
              <p class="profile__bio" id="profileBio"></p>
              <div class="profile__stats">
                <div class="profile__stat">
                  <span class="profile__stat-value" id="postCount">0</span>
                  <span class="profile__stat-label">Bài viết</span>
                </div>
                <div class="profile__stat">
                  <span class="profile__stat-value" id="followerCount">0</span>
                  <span class="profile__stat-label">Người theo dõi</span>
                </div>
                <div class="profile__stat">
                  <span class="profile__stat-value" id="followingCount">0</span>
                  <span class="profile__stat-label">Đang theo dõi</span>
                </div>
                <div class="profile__stat">
                  <span class="profile__stat-value" id="rankingCore">0</span>
                  <span class="profile__stat-label">Điểm xếp hạng</span>
                </div>
              </div>
            </div>
            <div class="profile__actions">
              <!-- Nút Edit Profile - chỉ hiện khi xem profile bản thân -->
              <button
                class="profile__btn profile__btn--edit"
                id="editProfileBtn"
                style="display: none"
              >
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path
                    d="M14.5 2.5L17.5 5.5L6.5 16.5H3.5V13.5L14.5 2.5Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                Chỉnh sửa
              </button>
              <!-- Nút Create Post - chỉ hiện khi xem profile bản thân -->
              <button
                class="profile__btn profile__btn--create-post"
                id="createPostBtn"
                style="display: none"
              >
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path
                    d="M10 5V15M5 10H15"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
                Tạo bài viết
              </button>
              <!-- Nút Follow - chỉ hiện khi xem profile người khác -->
              <button
                class="profile__btn profile__btn--follow"
                id="followBtn"
                style="display: none"
              >
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path
                    d="M10 5V15M5 10H15"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
                Theo dõi
              </button>
              <button
                class="profile__btn profile__btn--following"
                id="unfollowBtn"
                style="display: none"
              >
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path
                    d="M5 10L8.5 13.5L15 7"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                Đang theo dõi
              </button>
            </div>
          </div>
        </section>

        <!-- Edit Profile Modal - Chỉ hiện khi click nút Edit -->
        <section
          class="profile-edit"
          id="profileEditModal"
          style="display: none"
        >
          <div class="profile-edit__container">
            <div class="profile-edit__header">
              <h2 class="profile-edit__title">Chỉnh sửa thông tin</h2>
              <button class="profile-edit__close" id="closeEditModal">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M6 6L18 18M6 18L18 6"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
              </button>
            </div>
            <form class="profile-edit__form" id="editProfileForm">
              <div class="form__group">
                <label class="form__label" for="editFirstname">Tên</label>
                <input
                  type="text"
                  class="form__input"
                  id="editFirstname"
                  placeholder="Nhập tên của bạn"
                  required
                />
              </div>
              <div class="form__group">
                <label class="form__label" for="editLastname">Họ</label>
                <input
                  type="text"
                  class="form__input"
                  id="editLastname"
                  placeholder="Nhập họ của bạn"
                  required
                />
              </div>
              <div class="form__group">
                <label class="form__label" for="editAvatarUrl"
                  >URL Avatar</label
                >
                <input
                  type="url"
                  class="form__input"
                  id="editAvatarUrl"
                  placeholder="https://example.com/avatar.jpg"
                />
              </div>
              <div class="form__group">
                <label class="form__label" for="editBio">Tiểu sử</label>
                <textarea
                  class="form__textarea"
                  id="editBio"
                  rows="4"
                  placeholder="Viết vài dòng về bạn..."
                ></textarea>
              </div>
              <div
                class="form__error"
                id="editProfileError"
                style="display: none"
              >
                <svg
                  class="form__error-icon"
                  width="20"
                  height="20"
                  viewBox="0 0 20 20"
                  fill="none"
                >
                  <path
                    d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path
                    d="M10 6V10"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                  <path
                    d="M10 14H10.01"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
                <span class="form__error-text" id="editProfileErrorText"></span>
              </div>
              <button type="submit" class="form__button form__button--primary">
                Lưu thay đổi
              </button>
            </form>
          </div>
        </section>

        <!-- Create/Edit Post Modal -->
        <div class="post-modal" id="postModal" style="display: none">
          <div class="post-modal__overlay" id="postModalOverlay"></div>
          <div class="post-modal__container">
            <div class="post-modal__header">
              <h2 class="post-modal__title" id="postModalTitle">
                Tạo bài viết mới
              </h2>
              <button class="post-modal__close" id="closePostModal">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M6 6L18 18M6 18L18 6"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
              </button>
            </div>
            <form class="post-modal__form" id="postForm">
              <input type="hidden" id="postId" value="" />
              <div class="form__group">
                <label class="form__label" for="postTitle">Tiêu đề</label>
                <input
                  type="text"
                  class="form__input"
                  id="postTitle"
                  placeholder="Nhập tiêu đề bài viết..."
                  maxlength="255"
                  required
                />
              </div>
              <div class="form__group">
                <label class="form__label" for="postContent"
                  >Nội dung (Markdown)</label
                >
                <textarea
                  class="form__textarea form__textarea--markdown"
                  id="postContent"
                  rows="10"
                  placeholder="Viết nội dung bài viết bằng Markdown...&#10;&#10;Ví dụ:&#10;# Heading 1&#10;## Heading 2&#10;**Bold text**&#10;*Italic text*&#10;- List item&#10;```code```"
                  required
                ></textarea>
              </div>
              <div class="form__group">
                <label class="form__label" for="postTopics">Chủ đề</label>
                <div class="post-modal__topics" id="postTopicsList">
                  <!-- Topics will be dynamically loaded -->
                </div>
              </div>
              <div class="form__error" id="postError" style="display: none">
                <svg
                  class="form__error-icon"
                  width="20"
                  height="20"
                  viewBox="0 0 20 20"
                  fill="none"
                >
                  <path
                    d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path
                    d="M10 6V10"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                  <path
                    d="M10 14H10.01"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
                <span class="form__error-text" id="postErrorText"></span>
              </div>
              <button
                type="submit"
                class="form__button form__button--primary"
                id="postSubmitBtn"
              >
                Đăng bài viết
              </button>
            </form>
          </div>
        </div>

        <!-- User's Posts -->
        <section class="profile__posts">
          <h2 class="profile__posts-title">Bài viết</h2>
          <div class="posts" id="userPosts">
            <!-- Loading message -->
            <div class="posts__loading" id="postsLoading">
              <p>Đang tải bài viết...</p>
            </div>
            <!-- Posts will be dynamically loaded -->
          </div>
          <!-- Pagination -->
          <div class="pagination" id="postsPagination" style="display: none">
            <button
              class="pagination__btn pagination__btn--disabled"
              id="prevPageBtn"
              disabled
            >
              <svg
                class="pagination__icon"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
              >
                <path
                  d="M12.5 15L7.5 10L12.5 5"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              Trước
            </button>
            <div class="pagination__pages" id="paginationPages">
              <!-- Page numbers will be dynamically generated -->
            </div>
            <button class="pagination__btn" id="nextPageBtn">
              Sau
              <svg
                class="pagination__icon"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
              >
                <path
                  d="M7.5 15L12.5 10L7.5 5"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
        </section>
      </div>
    </main>

    <!-- Scripts -->
    <script src="/scripts/common.js"></script>
    <script src="/scripts/dropdown.js"></script>
    <script src="/scripts/profile.js"></script>
  </body>
</html>
